<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<div class="container-fluid" id="multiRowForm">
    <!-- Gesamte Column -->
    <div class="col-xs-12">
        <!-- Reihe für einen Lösungsansatz -->
        <div class="row form-row" v-for="row in rows">
            <!-- Innere Column im Lösungsansatz -->
            <div class="col col-xs-12">
                <div class="row mb-3">
                    <div class="col">
                        <select name="" id="" class="form-control" v-model="row.select">
                            <option :value="opt.value" v-for="opt in options">{% raw %} {{ opt.name }} {% endraw %}
                            </option>
                        </select>
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" placeholder="Gesetzesgrundlage" v.model="row.name">
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" placeholder="Summe" v.model="row.summe">
                    </div>
                    <div class="col">
                        <button class="btn btn-danger" @click="deleteRow(row)">Löschen</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="d-flex flex-row m-3">
            <div class="col">
                <button type="submit" class="btn btn-info">Lösen</button>
            </div>
            <div class="col">
                <button type="submit" class="btn btn-success" @click="addRow">Reihe hinzufügen</button>
            </div>
        </div>
    </div>
</div>
<script>
    const sachverhaltOptions = JSON.parse('{{cases_and_sums | tojson}}');
    console.log(sachverhaltOptions);

    const { createApp } = Vue
    createApp({
        el: '#multiRowForm',
        data() {
            return {
                options: sachverhaltOptions,
                rows: [
                    { 'select': 1, 'name': "" }
                ]
            };
        },
        methods: {
            addRow: function () {
                this.rows.push({ 'select': 1, 'name': "" });
            },
            deleteRow: function (row) {
                const filteredRow = this.rows.filter(element => element !== row);
                this.rows=filteredRow;
            }
        }
    }).mount('#multiRowForm')
</script>